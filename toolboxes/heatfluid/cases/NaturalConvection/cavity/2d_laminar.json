// -*- mode: javascript -*-
/*
- BARAKOS, G., MITSOULIS, Ee, et ASSIMACOPOULOS, D. O. Natural convection flow in a square cavity revisited: laminar and turbulent models with wall functions. International journal for numerical methods in fluids, 1994, vol. 18, no 7, p. 695-719.
- MARKATOS, Nikos C. et PERICLEOUS, K. A. Laminar and turbulent natural convection in an enclosed cavity. International journal of heat and mass transfer, 1984, vol. 27, no 5, p. 755-772.
- http://environ.chemeng.ntua.gr/en/Uploads/Doc/Papers/CFD/1994_Natural%20Convection%20in%20square%20cavity%20revised.pdf
*/
{
    "Name": "HeatFluid",
    "ShortName":"HeatFluid",
    "Models":
    {
        "fluid":{
            "equations":"Navier-Stokes"
        }
    },
    "Parameters":
    {
        "Ra":1e5,//1.89e5,//1e5,//1e6,//1e5//1e4,//1e6,
        "Pr":0.71
    },
    "Meshes":
    {
        "heatfluid":
        {
            "Import":
            {
                "filename":"$cfgdir/2d_laminar.geo",
                "hsize":0.03  // 0.01
            }
        }
    },
    "Materials":
    {
        "Omega":{
            "rho":"1",
            "mu":"sqrt(Pr/Ra):Pr:Ra",
            "k":"1/sqrt(Ra*Pr):Pr:Ra",
            "Cp":"1",
            "beta":"1"
        }
    },
    "BoundaryConditions":
    {
        "fluid":
        {
            "velocity":
            {
                "wall":
                {
                    "markers":["hot_wall","cold_wall","insulated"],
                    "expr":"{0,0}"
                }
            }
        },
        "heat":
        {
            "temperature":
            {
                "hot_wall":{ "expr":"0.5" },
                "cold_wall": { "expr":"-0.5" }
            }
        }
    },
    "PostProcess":
    {
        "heatfluid":
        {
            "Exports":
            {
                "fields":["fluid.velocity","fluid.pressure","heat.temperature","pid"]
            },
            "Measures":
            {
                "Statistics":
                {
                    "Nusselt_number":
                    {
                        "type":["integrate","max","min"],
                        "expr":"heat_dn_T:heat_dn_T",
                        "markers":"hot_wall"
                    },
                    "velocity_y_horizontal_centerline":
                    {
                        "type":["max","min"],
                        //"field":"fluid.velocity",
                        "expr":"fluid_U_1:fluid_U_1",
                        "markers":"horizontal_centerline"
                    },
                    "velocity_x_vertical_centerline":
                    {
                        "type":["max","min"],
                        //"field":"fluid.velocity",
                        "expr":"fluid_U_0:fluid_U_0",
                        "markers":"vertical_centerline"
                    }
                },
                "Points":
                {
                    "vertical_centerline":
                    {
                        "over_geometry":
                        {
                            "segment":
                            {
                                "point1":"{0.5,0}",
                                "point2":"{0.5,1}",
                                "n_points":100
                            }
                        },
                        "fields":["fluid.velocity","heat.temperature"],
                        "expressions":
                        {
                            "local_cell_Reynolds":"materials_Omega_rho*fluid_U_magnitude*h/materials_Omega_mu:materials_Omega_rho:fluid_U_magnitude:h:materials_Omega_mu",
                            "local_cell_Peclet":"materials_Omega_rho*fluid_U_magnitude*h/materials_Omega_k:materials_Omega_rho:fluid_U_magnitude:h:materials_Omega_k"
                        },
                        "include_coordinates":1,
                        "output":
                        {
                            "type":"table"
                        }
                    },
                    "horizontal_centerline":
                    {
                        "over_geometry":
                        {
                            "segment":
                            {
                                "point1":"{0,0.5}",
                                "point2":"{1,0.5}",
                                "n_points":100
                            }
                        },
                        "fields":["fluid.velocity","heat.temperature"],
                        "include_coordinates":1,
                        "output":
                        {
                            "type":"table"
                        }
                    }
                }
            },
            "Checkers":
            {
                "Measures":
                {
                    "Statistics_Nusselt_number_integrate":
                    {
                        "value":4.51,
                        "tolerance":1e-1
                    },
                    "Statistics_Nusselt_number_max":
                    {
                        "value":7.636,
                        "tolerance":1e-1
                    },
                    "Statistics_Nusselt_number_min":
                    {
                        "value":0.773,
                        "tolerance":1e-1
                    },
                    "Statistics_velocity_y_horizontal_centerline_max":
                    {
                        "value":0.258,
                        "tolerance":1e-1
                    },
                    "Statistics_velocity_x_vertical_centerline_max":
                    {
                        "value":0.132,
                        "tolerance":1e-1
                    }
                }
            }
        }
    }
}
