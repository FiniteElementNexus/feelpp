{
    "Name": "HDG-Electro-Thermo ",
    "ShortName":"ET",
    "Models":
    {
        "equations":"hdg",
        "p_expr":"2*dif/Pi*atan2(y,x):x:y:z:dif",
        "u_expr":"{2*sigma0*dif/Pi*y/(x*x+y*y),-2*sigma0*dif/Pi*x/(x*x+y*y),0}:x:y:z:dif:sigma0"
    },
    "Parameters":
    {
        "dif":0.05,
        // "dif":0.1,
        // "intensity":-800,
        "angle":"Pi/2",
        "intensity":"-sigma0/angle*dif*log(2):sigma0:angle:dif",
        "sigma0":58e3,
        "k0":0.38,
        "hc":0.08,
        "Tw":293,
        "a":77.32406120073146,
        "r0":1.2728918013826793,
        "Tm":474.7493592202795
    },
    "Materials":
    {
        "omega":
        {
            "physics":["heat","electric"],
            "alpha":"3.6e-3",
            "T0":"293",
            "sigma0":"58e3",
            "Lorentz":2.47e-8,
            // "sigma":"sigma0:sigma0",
            "sigma":"sigma0/(1+alpha*(heat_T-T0)):sigma0:alpha:heat_T:T0",
            "k0":"0.380",
            // "k":"sigma0*Lorentz*heat_T/(1+alpha*(T-T0)):sigma0:alpha:T0:Lorentz:heat_T"
            // "k":"k0:k0",
            "k":"k0*heat_T/((1+alpha*(heat_T-T0))*T0):k0:heat_T:alpha:T0",
            "electric_c":"sigma0:sigma0",
            "heat_c":"k0:k0"
        }
    },
    "InitialConditions":
    {
        "heat":{
            "temperature":
            {
                "Expression":
                {
                    "myic1":
                    {
                        "markers":"omega",
                        "expr": "293"
                    }
                }
            }
        }
    },
    "BoundaryConditions":
    {
        "electric":
        {
            "Integral":
            {
                "V0":
                {
                    "expr":"intensity:intensity"
                }
            },
            "Dirichlet":
            {
                // "V0":
                // {
                //     "expr":"dif:dif"
                // },
                "V1":
                {
                    "expr":"0"
                }
            },
            "Neumann":
            {
                "Rint":
                {
                    "expr":"0"
                },
                "Rext":
                {
                    "expr":"0"
                },
                "top":
                {
                    "expr":"0"
                },
                "bottom":
                {
                    "expr":"0"
                }
            }
        },
        "heat":
        {
            "Robin":
            {
                "Rint":
                {
                    "expr1":"-hc:hc",
                    "expr2":"-hc*Tw:hc:Tw"
                },
                "Rext":
                {
                    "expr1":"-hc:hc",
                    "expr2":"-hc*Tw:hc:Tw"
                }
            },
            "Neumann":
            {
                "V0":
                {
                    "expr":"0"
                },
                "V1":
                {
                    "expr":"0"
                },
                "top":
                {
                    "expr":"0"
                },
                "bottom":
                {
                    "expr":"0"
                }
            }
        }
    },
    "PostProcess":
    {
        "electric":
        {
            "Exports":
            {
                "fields": ["all"],
                "expr":
                {
                    "Jex":"{sigma0*dif/angle*y/(x*x+y*y),-sigma0*dif/angle*x/(x*x+y*y),0}:x:y:dif:angle:sigma0"
                }
            },
            "Measures":
            {
                "Points":
                {
                    "%1_1%":
                    {
                        "coord":"%1_2%",
                        "fields":"electric-potential",
                        "index1": [ ["V0", "{0,1.5,0.5}"],
                                    ["V1", "{1.5,0,0.5}"]
                                  ]
                    }
                },
                "Statistics":
                {
                    "Intentsity0":
                    {
                        "type":"integrate",
                        "field":"current-density",
                        "markers":"V0"
                    },
                    "Intentsity1":
                    {
                        "type":"integrate",
                        "field":"current-density",
                        "markers":"V1"
                    },
                    "Power":
                    {
                        "type":"integrate",
                        "expr":"-electric_Cx*electric_dxP-electric_Cy*electric_dyP-electric_Cz*electric_dzP:electric_Cx:electric_dxP:electric_Cy:electric_dyP:electric_Cz:electric_dzP",
                        "markers":"omega"
                    }
                },
                "Norm":
                {
                    "errorV":
                    {
                        "type":"L2-error",
                        "field":"electric-potential",
                        "solution":"dif/angle*atan2(y,x):x:y:dif:angle"
                    },
                    "errorJ":
                    {
                        "type":"L2-relative-error",
                        "field":"current-density",
                        "solution":"{sigma0*dif/angle*y/(x*x+y*y),-sigma0*dif/angle*x/(x*x+y*y),0}:x:y:dif:angle:sigma0"
                    }
                }
            },
            "Checkers":
            {
                "Measures":
                {
                    "Statistics_Intentsity0_integrate_0":
                    {
                        "value":"sigma0/angle*dif*log(2):sigma0:angle:dif",
                        "tolerance":1e-3
                    },
                    "Statistics_Intentsity1_integrate_1":
                    {
                        "value":"-sigma0/angle*dif*log(2):sigma0:angle:dif",
                        "tolerance":1e-3
                    },
                    "Norm_errorV_L2-error":
                    {
                        "value":0,
                        "tolerance":1e-3
                    },
                    "Norm_errorJ_L2-relative-error":
                    {
                        "value":0,
                        "tolerance":1e-2
                    }
                }
            }
        },
        "heat":
        {
            "Exports":
            {
                "fields": ["all"],
                "expr":
                {
                    "Tex":"-a*log(sqrt(x*x+y*y))^2+Tm:x:y:a:Tm"
                }
            },
            "Measures":
            {
                "Points":
                {
                    "T0":
                    {
                        "coord":"{1.06,1.06,1}",
                        "fields":"temperature"
                    }
                },
                "Statistics":
                {
                    "MeantT":
                    {
                        "type":["min","max","mean"],
                        "field":"temperature"
                    },
		            "Flux_%1_1%":
		            {
			            "type":"integrate",
			            "expr":"h*(heat_T-Tw):heat_T:h:Tw",
			            "markers":"%1_1%",
			            "index1":[ ["Rext", "h", "Tw"],
				                   ["Rint", "h", "Tw"]
                                 ]
                    }
                },
                "Norm":
                {
                    "errorT":
                    {
                        "type":"L2-relative-error",
                        "field":"temperature",
                        "solution":"-a*log(sqrt(x*x+y*y))^2+Tm:x:y:a:Tm"
                    }
                }
            },
            "Checkers":
            {
                "Measures":
                {
                    "Statistics_MeantT_max":
                    {
                        "value":474.7493592202795,
                        "tolerance":1e-3
                    },
                    "Norm_errorT_L2-relative-error":
                    {
                        "value":0,
                        "tolerance":5e-2
                    }
                }
            }
        }
    }
}
